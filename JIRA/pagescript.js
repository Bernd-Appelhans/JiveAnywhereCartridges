/* * *      Copyright 2013 Jive Software * *      Licensed under the Apache License, Version 2.0 (the "License"); *      you may not use this file except in compliance with the License. *      You may obtain a copy of the License at * *         http://www.apache.org/licenses/LICENSE-2.0 * *      Unless required by applicable law or agreed to in writing, software *      distributed under the License is distributed on an "AS IS" BASIS, *      WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. *      See the License for the specific language governing permissions and *      limitations under the License. */// PageModuleContext and $ are provided by the module manager// Page helper function called by onGetPreviewData to extract fields out of the pagethis.getPreviewData = function (params, sendResponse) {    var issue = new Object();    var baseUrl = 'https://issues.jivesoftware.com';    issue.defectTitle = clean($('#summary-val').text());    issue.projectUrl = $('#project-name-val').attr('href');    issue.projectName = clean($('#project-name-val').text());    issue.defectId = clean($('#key-val').text());    issue.defectType = clean($('#type-val').text());    issue.status = clean($('#status-val').text());    issue.priority = clean($('#priority-val').text());    issue.resolution = clean($('#resolution-val').text());    sendResponse(issue);};// Remote whitespaces from the given textvar clean = function (txt) {    var tmp = $.trim(txt.replace(/\n/g, '').replace(/\t/g, '')).split(' ');    var tmp2 = [];    for (var i = 0; i < tmp.length; i++) {        if (tmp[i] != '') {            tmp2.push(tmp[i]);        }    }    return tmp2.join(' ');}; 