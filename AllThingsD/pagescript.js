/* * *      Copyright 2013 Jive Software * *      Licensed under the Apache License, Version 2.0 (the "License"); *      you may not use this file except in compliance with the License. *      You may obtain a copy of the License at * *         http://www.apache.org/licenses/LICENSE-2.0 * *      Unless required by applicable law or agreed to in writing, software *      distributed under the License is distributed on an "AS IS" BASIS, *      WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. *      See the License for the specific language governing permissions and *      limitations under the License. */// PageModuleContext and $ are provided by the module manager// Page helper function called by onGetPreviewData to extract fields out of the pagethis.getPreviewData = function (params, sendResponse) {    var story = new Object();    story.title = clean($('.article-title h1.title').text());    story.url = document.location.href;    story.intro1 = clean($('.article-text p:eq(0)').text());    story.intro2 = clean($('.article-text p:eq(1)').text());    story.image = $('.article-body img').first().attr('src');    if (!story.image) {        // use logo image if image not found in story        story.image = 'https://twimg0-a.akamaihd.net/profile_images/3121995727/217f721fb1e3311c56da15206b5848fa.jpeg';    }    sendResponse(story);};// Remote whitespaces from the given textvar clean = function (txt) {    var tmp = $.trim(txt.replace(/\n/g, '').replace(/\t/g, '')).split(' ');    var tmp2 = [];    for (var i = 0; i < tmp.length; i++) {        if (tmp[i] != '') {            tmp2.push(tmp[i]);        }    }    return tmp2.join(' ');}; 